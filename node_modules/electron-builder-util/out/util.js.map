{
  "version": 3,
  "file": "util.js",
  "sourceRoot": "",
  "sources": [
    "../src/util.ts"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "import BluebirdPromise from \"bluebird-lst\"\nimport { red, yellow } from \"chalk\"\nimport { ChildProcess, execFile, spawn as _spawn, SpawnOptions } from \"child_process\"\nimport { createHash } from \"crypto\"\nimport _debug from \"debug\"\nimport { homedir, tmpdir } from \"os\"\nimport * as path from \"path\"\nimport \"source-map-support/register\"\nimport { statOrNull } from \"./fs\"\nimport { log, warn } from \"./log\"\n\nexport const debug = _debug(\"electron-builder\")\nexport const debug7z = _debug(\"electron-builder:7z\")\n\nconst DEFAULT_APP_DIR_NAMES = [\"app\", \"www\"]\n\nexport interface BaseExecOptions {\n  cwd?: string\n  env?: any\n  stdio?: any\n}\n\nexport interface ExecOptions extends BaseExecOptions {\n  customFds?: any\n  encoding?: string\n  timeout?: number\n  maxBuffer?: number\n  killSignal?: string\n}\n\nexport function removePassword(input: string) {\n  return input.replace(/(-P |pass:| \\/p|-pass )([^ ]+)/g, function (match, p1, p2) {\n    return `${p1}${createHash(\"sha256\").update(p2).digest(\"hex\")} (sha256 hash)`\n  })\n}\n\nexport function execWine(file: string, args: Array<string>, options?: ExecOptions): Promise<string> {\n  return exec(process.platform === \"win32\" ? file : \"wine\", prepareArgs(args, file), options)\n}\n\nexport function prepareArgs(args: Array<string>, exePath: string) {\n  if (process.platform !== \"win32\") {\n    args.unshift(exePath)\n  }\n  return args\n}\n\nexport function exec(file: string, args?: Array<string> | null, options?: ExecOptions): Promise<string> {\n  if (debug.enabled) {\n    debug(`Executing ${file} ${args == null ? \"\" : removePassword(args.join(\" \"))}`)\n  }\n\n  return new BluebirdPromise<string>((resolve, reject) => {\n    execFile(file, <any>args, options, function (error, stdout, stderr) {\n      if (error == null) {\n        if (debug.enabled) {\n          if (stderr.length !== 0) {\n            log(stderr)\n          }\n          if (stdout.length !== 0) {\n            log(stdout)\n          }\n        }\n        resolve(stdout)\n      }\n      else {\n        let message = red(removePassword(`Exit code: ${(<any>error).code}. ${error.message}`))\n        if (stdout.length !== 0) {\n          message += `\\n${yellow(stdout)}`\n        }\n        if (stderr.length !== 0) {\n          message += `\\n${red(stderr)}`\n        }\n\n        reject(new Error(message))\n      }\n    })\n  })\n}\n\nexport function doSpawn(command: string, args: Array<string>, options?: SpawnOptions, pipeInput?: Boolean): ChildProcess {\n  if (options == null) {\n    options = {}\n  }\n  if (options.stdio == null) {\n    options.stdio = [pipeInput ? \"pipe\" : \"ignore\", debug.enabled ? \"inherit\" : \"pipe\", \"pipe\"]\n  }\n\n  if (debug.enabled) {\n    const argsString = args.join(\" \")\n    debug(`Spawning ${command} ${command === \"docker\" ? argsString : removePassword(argsString)}`)\n  }\n  return _spawn(command, args, options)\n}\n\nexport function spawn(command: string, args?: Array<string> | null, options?: SpawnOptions): Promise<any> {\n  return new BluebirdPromise<any>((resolve, reject) => {\n    handleProcess(\"close\", doSpawn(command, args || [], options), command, resolve, reject)\n  })\n}\n\nexport function handleProcess(event: string, childProcess: ChildProcess, command: string, resolve: ((value?: any) => void) | null, reject: (reason?: any) => void) {\n  childProcess.on(\"error\", reject)\n\n  let out = \"\"\n  if (!debug.enabled && childProcess.stdout != null) {\n    childProcess.stdout.on(\"data\", (data: string) => {\n      out += data\n    })\n  }\n\n  let errorOut = \"\"\n  if (childProcess.stderr != null) {\n    childProcess.stderr.on(\"data\", (data: string) => {\n      errorOut += data\n    })\n  }\n\n  childProcess.once(event, (code: number) => {\n    if (code === 0 && debug.enabled) {\n      debug(`${command} (${childProcess.pid}) exited with code ${code}`)\n    }\n\n    if (code !== 0) {\n      function formatOut(text: string, title: string) {\n        if (text.length === 0) {\n          return \"\"\n        }\n        else {\n          return `\\n${title}:\\n${text}`\n        }\n      }\n\n      reject(new Error(`${command} exited with code ${code}${formatOut(out, \"Output\")}${formatOut(errorOut, \"Error output\")}`))\n    }\n    else if (resolve != null) {\n      resolve()\n    }\n  })\n}\n\nexport async function computeDefaultAppDirectory(projectDir: string, userAppDir: string | null | undefined): Promise<string> {\n  if (userAppDir != null) {\n    const absolutePath = path.resolve(projectDir, userAppDir)\n    const stat = await statOrNull(absolutePath)\n    if (stat == null) {\n      throw new Error(`Application directory ${userAppDir} doesn't exists`)\n    }\n    else if (!stat.isDirectory()) {\n      throw new Error(`Application directory ${userAppDir} is not a directory`)\n    }\n    else if (projectDir === absolutePath) {\n      warn(`Specified application directory \"${userAppDir}\" equals to project dir — superfluous or wrong configuration`)\n    }\n    return absolutePath\n  }\n\n  for (const dir of DEFAULT_APP_DIR_NAMES) {\n    const absolutePath = path.join(projectDir, dir)\n    const packageJson = path.join(absolutePath, \"package.json\")\n    const stat = await statOrNull(packageJson)\n    if (stat != null && stat.isFile()) {\n      return absolutePath\n    }\n  }\n  return projectDir\n}\n\nexport function use<T, R>(value: T | null, task: (it: T) => R): R | null {\n  return value == null ? null : task(value)\n}\n\nexport function debug7zArgs(command: \"a\" | \"x\"): Array<string> {\n  const args = [command, \"-bd\"]\n  if (debug7z.enabled) {\n    args.push(\"-bb3\")\n  }\n  else if (!debug.enabled) {\n    args.push(\"-bb0\")\n  }\n  return args\n}\n\nexport let tmpDirCounter = 0\n// add date to avoid use stale temp dir\nconst tempDirPrefix = `${process.pid.toString(16)}-${Date.now().toString(16)}`\n\nexport function getTempName(prefix?: string | null | undefined): string {\n  return `${prefix == null ? \"\" : `${prefix}-`}${tempDirPrefix}-${(tmpDirCounter++).toString(16)}`\n}\n\nexport function isEmptyOrSpaces(s: string | null | undefined) {\n  return s == null || s.trim().length === 0\n}\n\nexport function asArray<T>(v: null | undefined | T | Array<T>): Array<T> {\n  if (v == null) {\n    return []\n  }\n  else if (Array.isArray(v)) {\n    return v\n  }\n  else {\n    return [v]\n  }\n}\nexport function getCacheDirectory(): string {\n  if (process.platform === \"darwin\") {\n    return path.join(homedir(), \"Library\", \"Caches\", \"electron-builder\")\n  }\n\n  const localappdata = process.env.LOCALAPPDATA\n  if (process.platform === \"win32\" && localappdata != null) {\n    // https://github.com/electron-userland/electron-builder/issues/1164\n    if (localappdata.toLowerCase().includes(\"\\\\windows\\\\system32\\\\\") || (process.env.USERNAME || \"\").toLowerCase() === \"system\") {\n      return path.join(tmpdir(), \"electron-builder-cache\")\n    }\n    return path.join(localappdata, \"electron-builder\", \"cache\")\n  }\n\n  return path.join(homedir(), \".cache\", \"electron-builder\")\n}\n\n// fpm bug - rpm build --description is not escaped, well... decided to replace quite to smart quote\n// http://leancrew.com/all-this/2010/11/smart-quotes-in-javascript/\nexport function smarten(s: string): string {\n  // opening singles\n  s = s.replace(/(^|[-\\u2014\\s(\\[\"])'/g, \"$1\\u2018\")\n  // closing singles & apostrophes\n  s = s.replace(/'/g, \"\\u2019\")\n  // opening doubles\n  s = s.replace(/(^|[-\\u2014/\\[(\\u2018\\s])\"/g, \"$1\\u201c\")\n  // closing doubles\n  s = s.replace(/\"/g, \"\\u201d\")\n  return s\n}\n\nexport class Lazy<T> {\n  private _value: Promise<T>\n  private creator: (() => Promise<T>) | null\n\n  get value(): Promise<T> {\n    if (this.creator == null) {\n      return this._value\n    }\n\n    this._value = this.creator()\n    this.creator = null\n    return this._value\n  }\n\n  constructor(creator: () => Promise<T>) {\n    this.creator = creator\n  }\n}\n\nexport function addValue<K, T>(map: Map<K, Array<T>>, key: K, value: T) {\n  const list = map.get(key)\n  if (list == null) {\n    map.set(key, [value])\n  }\n  else if (!list.includes(value)) {\n    list.push(value)\n  }\n}\n\nexport function replaceDefault(inList: Array<string> | null | undefined, defaultList: Array<string>): Array<string> {\n  if (inList == null) {\n    return defaultList\n  }\n\n  const index = inList.indexOf(\"default\")\n  if (index >= 0) {\n    let list = inList.slice(0, index)\n    list.push(...defaultList)\n    if (index != (inList.length - 1)) {\n      list.push(...inList.slice(index + 1))\n    }\n    inList = list\n  }\n  return inList\n}\n\nexport function getPlatformIconFileName(value: string | null | undefined, isMac: boolean) {\n  if (value === undefined) {\n    return undefined\n  }\n  if (value === null) {\n    return null\n  }\n\n  if (!value.includes(\".\")) {\n    return `${value}.${isMac ? \"icns\" : \"ico\"}`\n  }\n\n  return value.replace(isMac ? \".ico\" : \".icns\", isMac ? \".icns\" : \".ico\")\n}\n\nexport function isPullRequest() {\n  // TRAVIS_PULL_REQUEST is set to the pull request number if the current job is a pull request build, or false if it’s not.\n  function isSet(value: string) {\n    // value can be or null, or empty string\n    return value && value !== \"false\"\n  }\n\n  return isSet(process.env.TRAVIS_PULL_REQUEST) || isSet(process.env.CI_PULL_REQUEST) || isSet(process.env.CI_PULL_REQUESTS)\n}\n\nexport function safeStringifyJson(data: any) {\n  return JSON.stringify(data, (name, value) => {\n    if (name.endsWith(\"Password\") || name.endsWith(\"Token\") || name.includes(\"password\") || name.includes(\"token\")) {\n      return \"<stripped sensitive data>\"\n    }\n    return value\n  }, 2)\n}"
  ]
}
